@let state = vm.state();

<main
  [class.p-landing--menu-collapsed]="state.menuCollapsed"
  class="p-landing"
  aria-labelledby="landing-title"
>
  <div class="p-landing__sr-live" aria-live="polite">
    {{ state.liveAnnouncement }}
  </div>

  @if (state.speechBanner) {
    <section class="p-landing__banner" role="alert" aria-live="assertive">
      <div class="p-landing__banner-content">
        <h2 class="p-landing__banner-title">{{ state.speechBanner.title }}</h2>
        <p class="p-landing__banner-message">{{ state.speechBanner.description }}</p>
      </div>
      <button
        (click)="onDismissBanner()"
        type="button"
        class="c-button c-button--ghost p-landing__banner-close"
      >
        {{ state.locale === 'en' ? 'Close message' : 'Cerrar mensaje' }}
      </button>
    </section>
  }

  <div class="p-landing__layout">
    <header class="p-landing__header">
      <img width="100x" src="/assets/logo.webp" alt="Logo pictotalking" />
      <h1 id="landing-title" class="p-landing__title">Pictotalking</h1>
    </header>

    <pic-landing-aside
      [sections]="state.sections"
      [locale]="state.locale"
      [menuCollapsed]="state.menuCollapsed"
      [activeSectionId]="state.activeSectionId"
      (sectionSelected)="onSelectSection($event)"
      (sidebarToggled)="onToggleMenu()"
    />

    <section class="p-landing__content" aria-live="polite">
      <h2 class="p-landing__content-title">
        {{ state.locale === 'en' ? 'Explore categories' : 'Explora categorías' }}
      </h2>

      @if (state.loading) {
        <div class="p-landing__skeleton-grid" aria-hidden="true">
          @for (skeleton of [1, 2, 3, 4, 5, 6, 7, 8]; track skeleton) {
            <div class="p-landing__skeleton-card"></div>
          }
        </div>
      } @else {
        @if (state.categories.length > 0) {
          <ul class="p-landing__categories" role="list">
            @for (category of state.categories; track category.id) {
              <li
                [class.p-landing__categories-item--expanded]="
                  expandedCategoryId() === category.id
                "
                class="p-landing__categories-item"
              >
                <pic-card
                  [class.p-landing__category-card--expanded]="
                    expandedCategoryId() === category.id
                  "
                  [id]="category.id"
                  [title]="category.title"
                  [pictogramUrl]="category.pictogramUrl"
                  [imageAlt]="category.imageAlt"
                  [ariaLabel]="
                    state.locale === 'en'
                      ? 'Play ' + category.title
                      : 'Reproducir ' + category.title
                  "
                  [isExpanded]="expandedCategoryId() === category.id"
                  (activate)="onCategoryActivate($event)"
                >
                </pic-card>
              </li>
            }
          </ul>
        } @else {
          <p class="p-landing__empty-state" role="status">
            {{
              state.locale === 'en'
                ? 'There are no categories to show right now.'
                : 'No hay categorías para mostrar en este momento.'
            }}
          </p>
        }
      }
    </section>
  </div>
</main>
